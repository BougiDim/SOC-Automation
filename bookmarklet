javascript:(function(){
    // Grab highlighted text or ask
    var selection = window.getSelection().toString().trim();
    if (!selection) {
        selection = prompt("Enter lookup value (e.g. Event ID 4624):");
    }
    if (!selection) return;

    // URL to your JSON "encyclopedia"
    var dataURL = "https://raw.githubusercontent.com/BougiDim/SOC-Automation/main/info-database";

    fetch(dataURL)
        .then(response => {
            if (!response.ok) {
                throw new Error("HTTP " + response.status);
            }
            return response.json();
        })
        .then(data => {
            var key = selection;

            var digits = selection.match(/\d+/);
            if (digits && digits.length) {
                key = digits[0];
            }

            if (!data[key]) {
                var lowerSelection = selection.toLowerCase();
                var match = Object.keys(data).find(k => k.toLowerCase() === lowerSelection);
                if (match) {
                    key = match;
                }
            }

            var answer = data[key];
            if (!answer) {
                answer = "No entry found for: " + selection;
            }
            // Fancy popup
            var div = document.createElement("div");
            div.style.position = "fixed";
            div.style.top = "10%";
            div.style.left = "50%";
            div.style.transform = "translateX(-50%)";
            div.style.background = "#1e1e1e";
            div.style.color = "#fff";
            div.style.padding = "15px";
            div.style.border = "2px solid #888";
            div.style.borderRadius = "8px";
            div.style.zIndex = 9999;
            div.style.fontFamily = "monospace";
            div.innerText = selection + " â†’ " + answer;

            // Close on click
            div.onclick = function(){ div.remove(); };
            document.body.appendChild(div);
            setTimeout(function(){ div.remove(); }, 10000);
        })
        .catch(err => alert("Error fetching dictionary: " + err));
})();
